<div class="h-[calc(100vh-4rem)] flex-grow flex flex-row relative">
	<!-- Filter Sidebar -->
	<aside
		class="w-full h-full absolute sm:static sm:w-64 sm:h-auto px-3 py-4 flex-shrink-0 flex-grow-0 bg-slate-100 border-r border-slate-50 transition-[left]"
		[ngClass]="{'-left-full': !mobileShowFilters, 'left-0': mobileShowFilters}"
	>
		<h2 class="text-xl">
			Filter by
			<button
				class="sm:hidden text-base float-right px-2 py-1 bg-slate-200 rounded"
				(click)="toggleMobileFilters()"
			>
				Show Results &gt;
			</button>
		</h2>
		<hr class="my-2 border-t-2"/>

		<!-- Filter Options -->
		<ul class="pt-2">
			<li>
				<div>
					<h3 class="text-base">Term Code (Quarter)</h3>
					<div>

						<mat-form-field class="w-full">
							<mat-label>Term Code Filter</mat-label>
							<input
								#termInput
								type="text"
								placeholder="Select Term Code"
								matInput
								[formControl]="termControl"
								[matAutocomplete]="autoTerm"
							>
							<mat-autocomplete
								requireSelection
								#autoTerm="matAutocomplete"
								(optionSelected)="setTerm($event.option.value)"
							>
								<mat-option value="Default">
									(Default: Most Recent)
								</mat-option>
								<mat-option
									*ngFor="let term of validTerms"
									[value]="term"
								>
									{{term}}
								</mat-option>
							</mat-autocomplete>
						</mat-form-field>

					</div>
				</div>
			</li>

			<li>
				<div>
					<h3 class="text-base">Subject Code <span class="text-red-500">*</span></h3>
					<div>

						<mat-form-field class="w-full">
							<mat-label>Subject Code Filter</mat-label>
							<input
								#subjectCodeInput
								type="text"
								placeholder="Select Subject Code"
								matInput
								[formControl]="subjectCodeControl"
								[matAutocomplete]="auto"
								(focus)="resetAutofillSubjectCode()"
								(input)="applyPartialSubjectCodeFilter($event)"
							>
							<mat-autocomplete
								requireSelection
								#auto="matAutocomplete"
								(optionSelected)="setSubjectCode($event.option.value)"
							>
								<mat-option
									*ngFor="let option of filteredCodeOptions"
									[value]="option"
								>
									{{option}}
								</mat-option>
							</mat-autocomplete>
						</mat-form-field>

					</div>
				</div>
			</li>

			<li>
				<div>
					<h3 class="text-base">Subject Number</h3>
					<div>

						<mat-form-field class="w-full">
							<mat-label>Subject Number Filter</mat-label>
							<input
								#subjectNumberInput
								type="text"
								placeholder="Select Subject Number"
								matInput
								[formControl]="subjectNumberControl"
								[matAutocomplete]="autoNum"
								(focus)="resetAutofillSubjectNumber()"
								(input)="applyPartialSubjectNumberFilter($event)"
							>
							<mat-autocomplete
								requireSelection
								#autoNum="matAutocomplete"
								(optionSelected)="setSubjectNumber($event.option.value)"
							>
								<mat-option value="All">
									(All)
								</mat-option>
								<mat-option
									*ngFor="let option of filteredNumberOptions"
									[value]="option"
								>
									{{option}}
								</mat-option>
							</mat-autocomplete>
						</mat-form-field>

					</div>
				</div>
			</li>
		</ul>

	</aside>

	<!-- Results -->
	<section class="flex-grow flex flex-col px-4 py-2 overflow-y-auto">
		<h1 class="text-2xl">
			CRN Lookup Tool Results
		</h1>
		<div *ngIf="!results.length">
			<h2 class="text-sm text-slate-500">Filter by a Subject Code to begin</h2>
		</div>

		<div class="block py-2 sm:hidden">
			<button
				class="px-4 py-2 bg-slate-200 rounded"
				(click)="toggleMobileFilters()"
			>
				Open Filters
			</button>
		</div>

		<ng-container *ngIf="results.length !== 0">
			<div class="flex flex-col">
				<h2 class="text-lg">All Options:</h2>
				<a
					class="block text-blue-500"
					*ngFor="let option of results"
					routerLink="/chart/crn/{{option.crn}}"
					[queryParams]="{optimized: 1, term: appliedFilters.term}"
				>
					View Chart for {{option.crn}} - {{option.subject_code}} {{option.subject_number}}
				</a>
			</div>
		</ng-container>
	</section>
</div>
